<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Complaint App Prototype</title>
  <style>
    body { font-family: Arial, sans-serif; margin:0; background:#f9f9f9; }
    .screen { display:none; padding:20px; }
    .active { display:block; }
    .header { font-size:20px; margin-bottom:10px; }
    .button { background:#4CAF50; color:#fff; border:none; padding:10px 15px; margin:5px 0; cursor:pointer; }
    .button:hover { background:#45a049; }
    .inline { display:inline-block; margin-right:5px; }
    .table { border-collapse: collapse; width:100%; margin-top:10px; }
    .table th, .table td { border:1px solid #ccc; padding:8px; text-align:left; }
    textarea { width:100%; margin:5px 0; }
    input[type=text], input[type=password] { width:100%; margin:5px 0; padding:5px; }
    .feedback { width:100%; margin-top:5px; }
    .statusBox { background:#f0f0f0; padding:10px; margin-top:10px; border-radius:5px; }
  </style>
</head>
<body>

  <!-- Language Select -->
  <div id="screen1" class="screen active">
    <div class="header">Choose your Language</div>
    <button class="button" onclick="setLanguage('en')">English</button>
    <button class="button" onclick="setLanguage('ta')">родрооро┐ро┤рпН</button>
    <button class="button" onclick="setLanguage('hi')">рд╣рд┐рдиреНрджреА</button>
  </div>

  <!-- Dashboard -->
  <div id="screen2" class="screen">
    <div class="header" id="dashboardHeader">Dashboard</div>
    <button class="button" onclick="goTo('screenFileComplaint')">File a Complaint</button>
    <button class="button" onclick="trackComplaintPrompt()">Track Complaint</button>
    <button class="button" onclick="goTo('screenAdminLogin')">View Complaints</button>
  </div>

  <!-- File Complaint -->
  <div id="screenFileComplaint" class="screen">
    <div class="header">File a Complaint</div>
    <div>
      <strong>Select Category:</strong><br>
      <input type="checkbox" name="category" value="Road"> Road<br>
      <input type="checkbox" name="category" value="Water"> Water<br>
      <input type="checkbox" name="category" value="Electricity"> Electricity<br>
    </div>
    <div style="margin-top:10px;">
      <button class="button" onclick="capturePhoto()">Take On-Site Photo</button>
      <div id="photoPreview" style="margin-top:5px; display:none;"></div>
      <div id="locationPreview" style="margin-top:5px;"></div>
    </div>
    <div style="margin-top:10px;">
      <textarea id="textDesc" placeholder="Describe the issue (text)"></textarea>
      <button class="button" onclick="recordVoice()">Record Voice (mock)</button>
      <div id="voicePreview" style="margin-top:5px;"></div>
    </div>
    <div style="margin-top:10px;">
      <input type="text" id="userName" placeholder="Your Name (optional)">
      <input type="text" id="userMobile" placeholder="Mobile Number (optional)">
    </div>
    <label><input type="checkbox" id="agreeTerms"> I agree to terms</label><br>
    <button class="button" onclick="submitComplaint()">Submit Complaint</button>
  </div>

  <!-- Submission Success -->
  <div id="screenSubmission" class="screen">
    <div class="header">Complaint Verified</div>
    <p>Complaint submitted successfully!</p>
    <p>Your Complaint ID: <strong id="submittedId"></strong></p>
    <div class="statusBox">
      <strong>Status Timeline:</strong>
      <ul id="statusTimeline"></ul>
    </div>
    <button class="button" onclick="goTo('screen2')">Back to Dashboard</button>
  </div>

  <!-- Admin Login -->
  <div id="screenAdminLogin" class="screen">
    <div class="header">Admin Login</div>
    <input type="text" id="adminUser" placeholder="Username"><br>
    <input type="password" id="adminPass" placeholder="Password"><br>
    <button class="button" onclick="adminLogin()">Login</button>
  </div>

  <!-- Admin Dashboard -->
  <div id="screenAdminDashboard" class="screen">
    <div class="header">Complaints</div>
    <table class="table">
      <thead>
        <tr><th>ID</th><th>Category</th><th>Status</th><th>Name</th><th>Mobile</th><th>Action</th></tr>
      </thead>
      <tbody id="complaintTable"></tbody>
    </table>
    <button class="button" onclick="adminLogout()">Logout</button>
  </div>

<script>
let complaints = [];
let lastComplaint = {};
let currentLang = 'en';

// ЁЯФд Translations
const translations = {
  en: {
    dashboard: "Dashboard",
    fileComplaint: "File a Complaint",
    trackComplaint: "Track Complaint",
    viewComplaints: "View Complaints",
    fileComplaintHeader: "File a Complaint",
    selectCategory: "Select Category:",
    road: "Road", water: "Water", electricity: "Electricity",
    takePhoto: "Take On-Site Photo",
    describe: "Describe the issue (text)",
    recordVoice: "Record Voice (mock)",
    name: "Your Name (optional)",
    mobile: "Mobile Number (optional)",
    agree: "I agree to terms",
    submit: "Submit Complaint",
    verified: "Complaint Verified",
    submittedSuccess: "Complaint submitted successfully!",
    yourId: "Your Complaint ID:",
    statusTimeline: "Status Timeline:",
    back: "Back to Dashboard",
    adminLogin: "Admin Login",
    username: "Username",
    password: "Password",
    login: "Login",
    complaints: "Complaints",
    logout: "Logout"
  },
  ta: {
    dashboard: "роЯро╛ро╖рпНрокрпЛро░рпНроЯрпБ",
    fileComplaint: "рокрпБроХро╛ро░рпН рокродро┐ро╡рпБ",
    trackComplaint: "рокрпБроХро╛ро░рпН роиро┐ро▓рпИ роЕро▒ро┐роп",
    viewComplaints: "рокрпБроХро╛ро░рпНроХро│рпН рокро╛ро░рпНроХрпНроХ",
    fileComplaintHeader: "рокрпБроХро╛ро░рпН рокродро┐ро╡рпБ",
    selectCategory: "ро╡роХрпИропрпИ родрпЗро░рпНро╡рпБ роЪрпЖропрпНропро╡рпБроорпН:",
    road: "роЪро╛ро▓рпИ", water: "родрогрпНрогрпАро░рпН", electricity: "рооро┐ройрпНроЪро╛ро░роорпН",
    takePhoto: "роиро┐роХро┤рпНроиро┐ро▓рпИ рокрпБроХрпИрокрпНрокроЯроорпН роОроЯрпБроХрпНроХро╡рпБроорпН",
    describe: "рокро┐ро░роЪрпНроЪро┐ройрпИропрпИ ро╡ро┐ро╡ро░ро┐роХрпНроХро╡рпБроорпН",
    recordVoice: "роХрпБро░ро▓рпН рокродро┐ро╡рпБ (рокро╛роЪро╛роЩрпНроХрпБ)",
    name: "роЙроЩрпНроХро│рпН рокрпЖропро░рпН (ро╡ро┐ро░рпБрокрпНрокроорпН)",
    mobile: "роЕро▓рпИрокрпЗроЪро┐ роОрогрпН (ро╡ро┐ро░рпБрокрпНрокроорпН)",
    agree: "роиро┐рокроирпНродройрпИроХро│рпБроХрпНроХрпБ роЙроЯройрпНрокроЯрпБроХро┐ро▒рпЗройрпН",
    submit: "рокрпБроХро╛ро░рпН роЪрооро░рпНрокрпНрокро┐роХрпНроХ",
    verified: "рокрпБроХро╛ро░рпН роЪро░ро┐рокро╛ро░рпНроХрпНроХрокрпНрокроЯрпНроЯродрпБ",
    submittedSuccess: "рокрпБроХро╛ро░рпН ро╡рпЖро▒рпНро▒ро┐роХро░рооро╛роХ роЪрооро░рпНрокрпНрокро┐роХрпНроХрокрпНрокроЯрпНроЯродрпБ!",
    yourId: "роЙроЩрпНроХро│рпН рокрпБроХро╛ро░рпН роОрогрпН:",
    statusTimeline: "роиро┐ро▓рпИ роХро╛ро▓ро╡ро░ро┐роЪрпИ:",
    back: "роЯро╛ро╖рпНрокрпЛро░рпНроЯрпБроХрпНроХрпБ родро┐ро░рпБроорпНрок",
    adminLogin: "роиро┐ро░рпНро╡ро╛роХро┐ роЙро│рпНроирпБро┤рпИро╡рпБ",
    username: "рокропройро░рпН рокрпЖропро░рпН",
    password: "роХроЯро╡рпБроЪрпНроЪрпЖро╛ро▓рпН",
    login: "роЙро│рпНроирпБро┤рпИ",
    complaints: "рокрпБроХро╛ро░рпНроХро│рпН",
    logout: "ро╡рпЖро│ро┐ропрпЗро▒рпБ"
  },
  hi: {
    dashboard: "рдбреИрд╢рдмреЛрд░реНрдб",
    fileComplaint: "рд╢рд┐рдХрд╛рдпрдд рджрд░реНрдЬ рдХрд░реЗрдВ",
    trackComplaint: "рд╢рд┐рдХрд╛рдпрдд рдЯреНрд░реИрдХ рдХрд░реЗрдВ",
    viewComplaints: "рд╢рд┐рдХрд╛рдпрддреЗрдВ рджреЗрдЦреЗрдВ",
    fileComplaintHeader: "рд╢рд┐рдХрд╛рдпрдд рджрд░реНрдЬ рдХрд░реЗрдВ",
    selectCategory: "рд╢реНрд░реЗрдгреА рдЪреБрдиреЗрдВ:",
    road: "рд╕рдбрд╝рдХ", water: "рдкрд╛рдиреА", electricity: "рдмрд┐рдЬрд▓реА",
    takePhoto: "рдСрди-рд╕рд╛рдЗрдЯ рдлреЛрдЯреЛ рд▓реЗрдВ",
    describe: "рд╕рдорд╕реНрдпрд╛ рдХрд╛ рд╡рд┐рд╡рд░рдг рджреЗрдВ",
    recordVoice: "рдЖрд╡рд╛рдЬрд╝ рд░рд┐рдХреЙрд░реНрдб рдХрд░реЗрдВ (рдирдХрд▓реА)",
    name: "рдЖрдкрдХрд╛ рдирд╛рдо (рд╡реИрдХрд▓реНрдкрд┐рдХ)",
    mobile: "рдореЛрдмрд╛рдЗрд▓ рдирдВрдмрд░ (рд╡реИрдХрд▓реНрдкрд┐рдХ)",
    agree: "рдирд┐рдпрдо рдФрд░ рд╢рд░реНрддреЛрдВ рд╕реЗ рд╕рд╣рдордд рд╣реВрдБ",
    submit: "рд╢рд┐рдХрд╛рдпрдд рд╕рдмрдорд┐рдЯ рдХрд░реЗрдВ",
    verified: "рд╢рд┐рдХрд╛рдпрдд рд╕рддреНрдпрд╛рдкрд┐рдд",
    submittedSuccess: "рд╢рд┐рдХрд╛рдпрдд рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ рджрд░реНрдЬ рдХреА рдЧрдИ!",
    yourId: "рдЖрдкрдХреА рд╢рд┐рдХрд╛рдпрдд рдЖрдИрдбреА:",
    statusTimeline: "рд╕реНрдерд┐рддрд┐ рд╕рдордпрд░реЗрдЦрд╛:",
    back: "рдбреИрд╢рдмреЛрд░реНрдб рдкрд░ рд╡рд╛рдкрд╕ рдЬрд╛рдПрдВ",
    adminLogin: "рдПрдбрдорд┐рди рд▓реЙрдЧрд┐рди",
    username: "рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо",
    password: "рдкрд╛рд╕рд╡рд░реНрдб",
    login: "рд▓реЙрдЧрд┐рди",
    complaints: "рд╢рд┐рдХрд╛рдпрддреЗрдВ",
    logout: "рд▓реЙрдЧрдЖрдЙрдЯ"
  }
};

// ЁЯИп Apply translations
function setLanguage(lang) {
  currentLang = lang;
  applyTranslations();
  goTo('screen2');
}

function applyTranslations() {
  const t = translations[currentLang];
  if(!t) return;

  // Dashboard
  document.getElementById("dashboardHeader").innerText = t.dashboard;
  document.querySelector("button[onclick=\"goTo('screenFileComplaint')\"]").innerText = t.fileComplaint;
  document.querySelector("button[onclick=\"trackComplaintPrompt()\"]").innerText = t.trackComplaint;
  document.querySelector("button[onclick=\"goTo('screenAdminLogin')\"]").innerText = t.viewComplaints;

  // File Complaint
  document.querySelector("#screenFileComplaint .header").innerText = t.fileComplaintHeader;
  document.querySelector("#screenFileComplaint strong").innerText = t.selectCategory;
  let checkboxes = document.querySelectorAll("input[name='category']");
  checkboxes[0].nextSibling.textContent = " " + t.road;
  checkboxes[1].nextSibling.textContent = " " + t.water;
  checkboxes[2].nextSibling.textContent = " " + t.electricity;
  document.querySelector("#screenFileComplaint button[onclick='capturePhoto()']").innerText = t.takePhoto;
  document.getElementById("textDesc").placeholder = t.describe;
  document.querySelector("#screenFileComplaint button[onclick='recordVoice()']").innerText = t.recordVoice;
  document.getElementById("userName").placeholder = t.name;
  document.getElementById("userMobile").placeholder = t.mobile;
  document.getElementById("agreeTerms").nextSibling.textContent = " " + t.agree;
  document.querySelector("#screenFileComplaint button[onclick='submitComplaint()']").innerText = t.submit;

  // Submission
  document.querySelector("#screenSubmission .header").innerText = t.verified;
  document.querySelector("#screenSubmission p").innerText = t.submittedSuccess;
  document.getElementById("submittedId").previousSibling.textContent = " " + t.yourId + " ";
  document.querySelector("#statusTimeline").previousSibling.textContent = t.statusTimeline;
  document.querySelector("#screenSubmission button").innerText = t.back;

  // Admin login
  document.querySelector("#screenAdminLogin .header").innerText = t.adminLogin;
  document.getElementById("adminUser").placeholder = t.username;
  document.getElementById("adminPass").placeholder = t.password;
  document.querySelector("#screenAdminLogin button").innerText = t.login;

  // Admin dashboard
  document.querySelector("#screenAdminDashboard .header").innerText = t.complaints;
  document.querySelector("#screenAdminDashboard button").innerText = t.logout;
}

// ЁЯМР Navigation
function goTo(id){
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

// ЁЯУ╕ Mock Photo & Location
function capturePhoto(){
  lastComplaint.photo="https://via.placeholder.com/300";
  lastComplaint.timestamp=new Date().toLocaleString();
  lastComplaint.location="GPS: Lat 12.9716, Long 77.5946";
  document.getElementById('photoPreview').innerHTML=<img src="${lastComplaint.photo}" style="width:100%;max-width:300px;">;
  document.getElementById('photoPreview').style.display="block";
  document.getElementById('locationPreview').innerText=${lastComplaint.location}\nTime: ${lastComplaint.timestamp};
}

// ЁЯОЩ Mock Voice Recording
function recordVoice(){
  lastComplaint.voice="Voice message recorded (mock)";
  document.getElementById('voicePreview').innerText=lastComplaint.voice;
}

// ЁЯУй Submit Complaint
function submitComplaint(){
  if(!document.getElementById('agreeTerms').checked){alert("Agree to terms."); return;}
  let cats=[...document.querySelectorAll('input[name="category"]:checked')].map(c=>c.value).join(", ");
  if(!cats){alert("Select category."); return;}
  let id="C"+(complaints.length+1);
  let complaint={
    id, category:cats, status:"Submitted",
    name:document.getElementById('userName').value||"Anonymous",
    mobile:document.getElementById('userMobile').value||"",
    description:document.getElementById('textDesc').value,
    photo:lastComplaint.photo||"",
    voice:lastComplaint.voice||"",
    timestamp:lastComplaint.timestamp||"",
    location:lastComplaint.location||"",
    timeline:[{status:"Submitted", date:new Date().toLocaleString(), by:"User"}],
    feedback:""
  };
  complaints.push(complaint);
  document.getElementById('submittedId').innerText=id;
  updateStatusTimeline(id);
  lastComplaint={};
  goTo('screenSubmission');
}

// ЁЯУК Status Timeline
function updateStatusTimeline(id){
  let complaint=complaints.find(c=>c.id===id);
  let ul=document.getElementById('statusTimeline');
  ul.innerHTML="";
  complaint.timeline.forEach(t=>{
    let li=document.createElement("li");
    li.textContent=${t.date}: ${t.status} (${t.by});
    ul.appendChild(li);
  });
}

// ЁЯФС Admin Login
function adminLogin(){
  let u=document.getElementById('adminUser').value;
  let p=document.getElementById('adminPass').value;
  if(u==="CSE" && p==="123"){renderAdminDashboard(); goTo('screenAdminDashboard');}
  else alert("Invalid login");
}

// ЁЯУЛ Render Admin Dashboard
function renderAdminDashboard(){
  let tbody=document.getElementById('complaintTable'); tbody.innerHTML="";
  complaints.forEach((c,idx)=>{
    let tr=document.createElement("tr");
    tr.innerHTML=`<td>${c.id}</td>
      <td>${c.category}</td>
      <td>
        <select onchange="updateStatus(${idx},this.value)">
          <option ${c.status==='Submitted'?'selected':''}>Submitted</option>
          <option ${c.status==='Under Processing'?'selected':''}>Under Processing</option>
          <option ${c.status==='Resolved'?'selected':''}>Resolved</option>
        </select>
      </td>
      <td>${c.name}</td>
      <td>${c.mobile}</td>
      <td><button class="button inline" onclick="viewComplaint(${idx})">View</button></td>`;
    tbody.appendChild(tr);
  });
}

// ЁЯЫа Update status
function updateStatus(idx,status){
  complaints[idx].status=status;
  complaints[idx].timeline.push({status,date:new Date().toLocaleString(),by:"Admin"});
  renderAdminDashboard();
}

// ЁЯСА View Complaint & Feedback
function viewComplaint(idx){
  let c=complaints[idx];
  let info=ID: ${c.id}\nCategory: ${c.category}\nStatus: ${c.status}\nName: ${c.name}\nMobile: ${c.mobile}\nDescription: ${c.description}\nPhoto: ${c.photo}\nVoice: ${c.voice}\nLocation: ${c.location}\nTimestamp: ${c.timestamp}\nTimeline:\n${c.timeline.map(t=>t.date+": "+t.status+" ("+t.by+")").join("\n")};
  if(c.status==="Resolved"){
    let fb=prompt("Enter feedback for this resolved complaint:",c.feedback||"");
    if(fb) c.feedback=fb;
    info+="\nFeedback: "+(c.feedback||"None");
  }
  alert(info);
}

// ЁЯЪк Logout
function adminLogout(){goTo('screenAdminLogin');}

// ЁЯФН Track complaint
function trackComplaintPrompt(){
  let id = prompt("Enter Complaint ID to track:");
  if(!id) return;
  let complaint = complaints.find(c => c.id === id.trim());
  if(!complaint){
    alert("Complaint not found!");
    return;
  }
  let info = ID: ${complaint.id}\nCategory: ${complaint.category}\nStatus: ${complaint.status}\nTimeline:\n;
  complaint.timeline.forEach(t=>{
    info += ${t.date}: ${t.status} (${t.by})\n;
  });
  alert(info);
}
</script>
</body>
</html>
